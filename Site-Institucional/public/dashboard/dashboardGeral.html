<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Geral Fármacos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../styles/css-dash/dashboard.css">
    <link rel="icon" href="../img/logo F png.png">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"
        integrity="sha512-t2JWqzirxOmR9MZKu+BMz0TNHe55G5BZ/tfTmXMlxpUY8tsTo3QMD27QGoYKZKFAraIPDhFv56HLdN11ctmiTQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>
</head>
<body>
    <div class="conteudo">
        <div class="nav-lateral">
            <div class="logo-empresa">
                <img src="./../img/logo F png.png" alt="">
            </div>
            <div class="nav-itens">
                <li>
                    <ul><b>Nome</b></ul>
                    <ul><a href="cadastroAlerta.html">Alertas</a></ul>
                    <ul><a class="atual" href="dashboardGeral.html">Máquinas</a></ul>
                    <ul><a href="./listaUsuario.html">Usuários</a></ul>
                    <ul><a href="./editarDados.html">Editar dados</a></ul>
                </li>
            </div>
            <div class="btn-pdf"><button>Gerar PDF</button></div>
            <div class="btn-sair">
                <button>Sair</button>
            </div>
        </div>
        <div class="div-principal">
            <div class="div-superior">
                <div class="div-cpu">
                    <h2>CPU</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>
                </div>
                <div class="div-ram">
                    <h2>Memoria RAM</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>

                </div>
                <div class="div-rede">
                    <h2>Rede</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>
                </div>
        
                <div class="div-disco">
                    <h2>Disco</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>
                </div>
            </div>
            <div class="div-central">
                <div class="div-tab-ram">
                    <table>
                        <tr>
                            <th>Identificação da Máquina</th>
                            <th>Uso atual</th>
                            <th>Total de Ram</th>
                        </tr>
                        <tr>
                            <th>Máquina 1</th>
                            <th>60%</th>
                            <th>12 GB</th>
                        </tr>
                        <tr>
                            <th>Máquina 2</th>
                            <th>55%</th>
                            <th>8 GB</th>
                        </tr>
                    </table>
                </div>
                <div class="div-graf-disco"><canvas id="myChart4" style="width: 400px; height: 220px;"></canvas></div>

                <div class="div-list-maquinas">
                    <h2>Lista de Máquinas</h2>
                    <table>
                        <tr>
                            <th><a href=""> Geral</a></th>
                            <th></th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 1</a></th>
                            <th>Ativo</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 2</a></th>
                            <th>Ativo</th>
                        </tr>
                        <tr>
                            <th><a href="">Maquina 3</a></th>
                            <th>Ativo</th>
                        </tr>
                        <tr>
                            <th><a href="">Maquina 4</a></th>
                            <th>Inativo</th>
                        </tr>
                        <tr>
                            <th><a href="">Maquina 5</a></th>
                            <th>Ativo</th>
                        </tr>
                        <tr>
                            </th>
                            <th><a href="">Máquina 6</a></th>
                            <th>Ativo</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="div-inferior">
                <div class="div-graf-rede">
                    <canvas id="myChart2" style="width: 400px; height: 300px;"></canvas>
                </div>
                <div class="div-graf-cpu">
                    <canvas id="myChart1" style="width: 400px; height: 260px;"></canvas>
                </div>
                <div class="div-list-alertas">
                    <h2>Alertas</h2>
                    <table>
                        <tr>
                            <th><a href=""> </a></th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 1</a></th>
                            <th>16:02</th>
                            <th>CPU: 80%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 2</a></th>
                            <th>16:02</th>
                            <th>RAM: 90%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 3</a></th>
                            <th>09:02</th>
                            <th>DISCO: 98%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 1</a></th>
                            <th>19:02</th>
                            <th>CPU: 90%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 3</a></th>
                            <th>16:02</th>
                            <th>CPU: 90%</th>
                        </tr>

                    </table>
                </div>
            </div>

            <!-- <canvas id="myChart3" style="width: 250px; height: 200px;"></canvas> -->


        </div>
    </div>
</body>

<script>
  
    const ctx3 = document.getElementById('myChart3');
    var totalRam = "12";

    new Chart(ctx3, {

        type: 'doughnut',
        data: {
            labels: ['Em uso', 'Livre'], // colocar as horas
            datasets: [{
                data: [30, 70], // colocar o uso
                borderWidth: 3,
                cutout: '65%',
            }],
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: `Uso de memória RAM ${totalRam}`,
                },
                legend: {
                    display: true,
                    position: 'right',
                }
            }
        },
    });

    const ctx4 = document.getElementById('myChart4');

    new Chart(ctx4, {
        data: {
            datasets: [{
                type: 'bar',
                label: 'Gráfico de Disco',
                data: [12, 19, 15, 12, 17], // captura de rede
                borderWidth: 1,
                // backgroundColor: 'pink',
            }],
            labels: ['Máquina 1', 'Máquina 2']
        },
        options: {
            indexAxis: 'y',
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: 'Comparativo de Uso de Disco entre máquinas '
                }
            },
            // scales: {
            //     y: {
            //         beginAtZero: true
            //     }
            // }
        }
    });

    const ctx2 = document.getElementById('myChart2');

    new Chart(ctx2, {
        data: {
            datasets: [{
                type: 'bar',
                label: 'Pacotes Recebidos',
                data: [30, 35, 40, 50, 70, 20], // captura de rede
                borderWidth: 1,
            },
            {
                type: 'bar',
                label: 'Pacotes Enviados',
                data: [30, 35, 40, 50, 70, 20], // captura de rede
                borderWidth: 1,
            },
            ],
            labels: ['Máquina 1', 'Máquina 2']
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom',
                },
                title: {
                    display: true,
                    fontSize: 20,
                    text: "Comparação de pacotes recebidos e enviados por máquina diariamente",
                },
            }
        }
    });

    const ctx1 = document.getElementById('myChart1');

    new Chart(ctx1, {
        type: 'line',
        data: {
            labels: [1, 2, 3, 4, 5, 6,], // colocar as horas
            datasets: [{
                type: 'line',
                label: 'Alerta preocupante',
                data: [10, 10, 10, 10, 10, 10],
                borderWidth: 1.5,
                borderColor: '#6dc7ff',
                backgroundColor: '#6dc7ff',
            },
            {
                type: 'line',
                label: 'Alerta crítico',
                data: [20, 20, 20, 20, 20, 20],
                borderWidth: 1.5,
                borderColor: 'red',
                backgroundColor: 'red',
            },
            {
                label: 'Uso de CPU',
                data: [12, 19, 3, 5, 2, 3], // colocar o uso
                borderWidth: 3,
                borderColor: '#00323c',
                backgroundColor: '#00323c',
            }]
        },
        // configurar a cor de fundo
        const: bgColor ={
            id: 'bgColor',
            beforeDraw(chart1,steps, options) {
                const {ctx,chartArea:{ctx1,width,height}} = chart1;
                ctx1.faleStyle = 'options.backgroundColor';
                ctx1.fillRect(0,0,width,height);
                ctx1.restore();
            }

        },
    
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            },

            plugins: {
                title: {
                    display: true,
                    text: 'Uso de CPU em porcentagem em decorrência do tempo',
                    fontSize: 50,

                },
                legend: {
                    display: true,
                    position: 'bottom'
                },
                // cor de fundo da imagem
                bgColor:{
                    backgroundColor: 'white'
                }
            },
        }

    });

    function downloadPDF() {
        const canvas = document.getElementById('myChart1');
        //const canvas1 = document.getElementById('myChart2');
        //const canvas2 = document.getElementById('myChart3');
        //const canvas3 = document.getElementById('myChart4');

    //create image
    const canvasImage = canvas.toDataURL('image/jpeg', 1.0);
    //const canvasImage1 = canvas1.toDataURL('image/jpeg', 1.0);
   // const canvasImage2 = canvas2.toDataURL('image/jpeg', 1.0);
   // const canvasImage3 = canvas3.toDataURL('image/jpeg', 1.0);

console.log(canvasImage);

    let pdf = new jsPDF('landscape');
    pdf.setFontSize(20);
    pdf.addImage(canvasImage, 'JPEG', 0, 0, 150, 150);
    pdf.save('mychart.pdf');
    
    }
</script>