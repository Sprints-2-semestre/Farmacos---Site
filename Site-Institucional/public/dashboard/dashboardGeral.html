<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Geral Fármacos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../styles/css-dash/dashboard.css">
    <link rel="icon" href="../img/logo F png.png">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"
        integrity="sha512-t2JWqzirxOmR9MZKu+BMz0TNHe55G5BZ/tfTmXMlxpUY8tsTo3QMD27QGoYKZKFAraIPDhFv56HLdN11ctmiTQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>
</head>

<body
    onload="cardAlertasCPU(), cardAlertasRAM(),cardAlertasDISCO(), cardAlertasREDE(), obterDadosGrafico2(), obterDadosGrafico3(), obterDadosGrafico4(), listagemAlerta()">
    <div class="conteudo">
        <div class="nav-lateral">
            <div class="logo-empresa">
                <img src="./../img/logo F png.png" alt="">
            </div>
            <div class="nav-itens">
                <li>
                    <ul><b>Nome</b></ul>
                    <ul><a href="cadastroAlerta.html">Alertas</a></ul>
                    <ul><a class="atual" href="dashboardGeral.html">Máquinas</a></ul>
                    <ul><a href="./listaUsuario.html">Usuários</a></ul>
                    <ul><a href="./editarDados.html">Editar dados</a></ul>
                </li>
            </div>
            <div class="btn-pdf"><button>Gerar PDF</button></div>
            <div class="btn-sair">
                <button>Sair</button>
            </div>
        </div>
        <div class="div-principal">
            <div class="nome-ame">
                <p>AME:</p>
                <p id="nomeAme"></p>
            </div>
            <div class="div-superior">
                <div class="div-cpu">
                    <h2>CPU</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p style="color:#FFC048;">Preocupante
                        <p style="color:#FFC048;" id="preocupanteCPU">%</p>
                        </p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Crítico
                        <p id="criticoCPU">%</p>
                        </p>
                    </div>
                </div>
                <div class="div-ram">
                    <h2>Memoria RAM</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p style="color:#FFC048;">Preocupante
                        <p style="color:#FFC048;" id="preocupanteRAM">%</p>
                        </p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Crítico
                        <p id="criticoRAM">%</p>
                        </p>
                    </div>

                </div>
                <div class="div-rede">
                    <h2>Rede</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p style="color:#FFC048;">Preocupante
                        <p id="preocupanteREDE">%</p>
                        </p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Crítico
                        <p id="criticoREDE">%</p>
                        </p>
                    </div>
                </div>

                <div class="div-disco">
                    <h2>Disco</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p style="color:#FFC048;">Preocupante
                        <p  style="color:#FFC048;" id="preocupanteDISCO">%</p>
                        </p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Crítico
                        <p id="criticoDISCO"></p></p>
                    </div>
                </div>
            </div>
            <div class="div-central">
                <div class="div-tab-ram">
                   
                    <canvas id="myChart4" style="width: 400px; height: 220px;"></canvas>
                </div>
                <div class="div-graf-disco">
                    <canvas id="myChart3" style="width: 400px; height: 220px;"></canvas>
                </div>

                <div class="div-list-maquinas">
                    <h2>Lista de Máquinas</h2>
                    <table id="feed_container" class="feed-container">
                        <tr id="colunas-container">
                            <th><a href=""> Geral</a></th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="div-inferior">
                <div class="div-graf-rede">
                    <canvas id="myChart2" style="width: 700px; height: 400px;"></canvas>
                </div>
                <div class="div-graf-cpu">
                    <canvas id="myChart1" style="width: 400px; height: 260px;"></canvas>
                </div>
                <div class="div-list-alertas">
                    <h2>Alertas</h2>
                    <table id="feed_container1" class="feed-container">
                        <tr id="colunas-container1">
                            <th><a href=""> Geral</a></th>
                        </tr>
                    </table>
                </div>
            </div>

        </div>
    </div>
</body>

<script>
    const btnPrint = document.querySelector(".btn-pdf");
    btnPrint.addEventListener("click", () => {

        const navLateral = document.querySelector(".nav-lateral"); // Supondo que "nav-lateral" é uma classe
        const divPrincipal = document.querySelector(".div-principal");

        if (navLateral) {
            navLateral.style.display = "none";
        }

        if (divPrincipal) {
            divPrincipal.style.width = "100%";
            divPrincipal.style.left = "0%";
        }
        // Cria uma folha de estilo CSS dinâmica para a impressão
        const printStyles = `
                @page {
                    size: A3 landscape; /* Tamanho da folha, pode ser A4, letter, legal, etc. */
                    margin: 1cm; /* Margens da página (por exemplo, 1cm em todos os lados) */
                }
            `;
        const style = document.createElement('style');
        style.textContent = printStyles;
        document.head.appendChild(style);

        // Inicia o diálogo de impressão
        window.print();

        if (navLateral) {
            navLateral.style.display = "flex";
        }

        if (divPrincipal) {
            divPrincipal.style.width = "81%";
            divPrincipal.style.left = "19%";
        }

        // Remove a folha de estilo após a impressão
        style.remove();
    });

    // Alertas
    function cardAlertasCPU() {
        console.log("Entrando no cardAlertasCPU()")

        fetch("/medidas/cardAlertasCPU").then(function (resposta) {
            if (resposta.ok) {

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];

                        preocupanteCPU.innerHTML = `${publicacao.medio}`
                        criticoCPU.innerHTML = `${publicacao.maximo}`
                    }
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    function cardAlertasRAM() {
        console.log("Entrando no cardAlertasRAM()")

        fetch("/medidas/cardAlertasRAM").then(function (resposta) {
            if (resposta.ok) {

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];

                        preocupanteRAM.innerHTML = `${publicacao.medio}`
                        criticoRAM.innerHTML = `${publicacao.maximo}`
                    }
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    function cardAlertasDISCO() {
        console.log("Entrando no cardAlertasDISCO()")

        fetch("/medidas/cardAlertasDISCO").then(function (resposta) {
            if (resposta.ok) {

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];

                        preocupanteDISCO.innerHTML = `${publicacao.medio}`
                        criticoDISCO.innerHTML = `${publicacao.maximo}`
                    }
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    function cardAlertasREDE() {
        console.log("Entrando no cardAlertasREDE()")

        fetch("/medidas/cardAlertasREDE").then(function (resposta) {
            if (resposta.ok) {

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];

                        preocupanteREDE.innerHTML = `${publicacao.medio}`
                        criticoREDE.innerHTML = `${publicacao.maximo}`
                    }
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    //ALERTAS

    // ALERTA CPU
    function dadosCPU() {
        console.log("Entrando no dadosCPU()")

        fetch("/medidas/dadosCPU").then(function (resposta) {
            if (resposta.ok) {
                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));
                    if(resposta[0].CPU >= Number(preocupanteCPU.innerHTML)){
                        inserirAlertaCPU(resposta)
                    } else if (resposta[0].CPU >= Number(criticoCPU.innerHTML)) {
                        inserirAlertaCPU(resposta)
                    }});
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    function inserirAlertaCPU(resposta) {

        var fkMaquina = resposta[0].fkMaquina;
        var dtHora = resposta[0].dtHora;
        var CPU = resposta[0].CPU;

        fetch("/medidas/inserirAlertaCPU", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                fkMaquinaServer: fkMaquina,
                dtHoraServer: dtHora,
                CPUServer: CPU,
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log("Cadastro realizado com sucesso! Redirecionando para a tela de login ...")

            } else {
                console.log("Erro ao cadastrar")
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
    };
const intervaloCPU = setInterval(dadosCPU, 3000);

    // MEMÓRIA RAM
    function dadosRAM() {
        console.log("Entrando no dadosRAM()")

        fetch("/medidas/dadosRAM").then(function (resposta) {
            if (resposta.ok) {
                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));
                    if(resposta[0].RAM >= Number(preocupanteRAM.innerHTML)){
                        inserirAlertaRAM(resposta)
                    }});
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    function inserirAlertaRAM(resposta) {
        var fkMaquina = resposta[0].fkMaquina;
        var dtHora = resposta[0].dtHora;
        var RAM = resposta[0].RAM;

        fetch("/medidas/inserirAlertaRAM", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                fkMaquinaServer: fkMaquina,
                dtHoraServer: dtHora,
                RAMServer: RAM,
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log("Cadastro realizado com sucesso! Redirecionando para a tela de login ...")

            } else {
                console.log("Erro ao cadastrar")
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
};
    const intervaloRAM = setInterval(dadosRAM, 2000);

    // DISCO
    function dadosDISCO() {
        console.log("Entrando no dadosDISCO()")

        fetch("/medidas/dadosDISCO").then(function (resposta) {
            if (resposta.ok) {
                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos DISCO: ", JSON.stringify(resposta));
                    if(resposta[0].usoAtualDisco >= Number(preocupanteDISCO.innerHTML)){
                        inserirAlertaDISCO(resposta)
                    }});
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    function inserirAlertaDISCO(resposta) {
        var fkMaquina = resposta[0].fkMaquina;
        var dtHora = resposta[0].dtHora;
        var DISCO = resposta[0].usoAtualDisco;

        fetch("/medidas/inserirAlertaDISCO", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                fkMaquinaServer: fkMaquina,
                dtHoraServer: dtHora,
                DISCOServer: DISCO,
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log("Cadastro realizado com sucesso! Redirecionando para a tela de login ...")

            } else {
                console.log("Erro ao cadastrar")
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
};
    const intervaloDISCO = setInterval(dadosDISCO, 2000);

    // REDE
    function dadosREDE() {
        console.log("Entrando no dadosREDE()")

        fetch("/medidas/dadosREDE").then(function (resposta) {
            if (resposta.ok) {

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    if(resposta[0].REDE >= Number(preocupanteREDE.innerHTML)){
                        inserirAlertaREDE(resposta)
                    }});
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

    function inserirAlertaREDE(resposta) {
        var fkMaquina = resposta[0].fkMaquina;
        var dtHora = resposta[0].dtHora;
        var REDE = resposta[0].REDE;

        fetch("/medidas/inserirAlertaREDE", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                fkMaquinaServer: fkMaquina,
                dtHoraServer: dtHora,
                REDEServer: REDE,
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log("Cadastro realizado com sucesso! Redirecionando para a tela de login ...")

            } else {
                console.log("Erro ao cadastrar")
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
};
    const intervaloREDE = setInterval(dadosREDE, 3000);

    // LISTAGEM ALERTAS

    function listagemAlerta () {
    console.log ("Entrando no listarAlertas()")

    fetch("/medidas/listagemAlerta/").then(function (resposta) {
    if (resposta.ok) {
        if (resposta.status == 204) {
            var feed = document.getElementById("feed_container1");
            var mensagem = document.createElement("span");
            mensagem.innerHTML = ""
            feed.appendChild(mensagem);
        }

        resposta.json().then(function (resposta) {
            console.log("Dados recebidos: ", JSON.stringify(resposta));
            var feed = document.getElementById("feed_container1");
            var colunas = document.getElementById("colunas-container1");
            feed.appendChild(colunas);

            for (let i = 0; i < resposta.length; i++) {
                var publicacao = resposta[i];

                var linha = document.createElement("tr");
                var idMaquina = document.createElement("td");
                var dtHoraAlerta = document.createElement("td");
                var nomeComponente = document.createElement("td");
                var porcentagem = document.createElement("td");

                idMaquina.innerHTML = `<span>${publicacao.idMaquinaAlerta}</span>`
                dtHoraAlerta.innerHTML = `<span>${publicacao.dtHoraAlerta}</span>`
                nomeComponente.innerHTML = `<span>${publicacao.nomeComponente}</span>`
                porcentagem.innerHTML = `<span>${publicacao.porcentagem}</span>`

                feed.appendChild(linha);
                linha.appendChild(idMaquina);
                linha.appendChild(dtHoraAlerta);
                linha.appendChild(nomeComponente);
                linha.appendChild(porcentagem);
            }
        });
    } else {
        throw ('Houve um erro na API!');
    }
}).catch(function (resposta) {
    console.error(resposta);
});
    }

    // FIM LISTAGEM ALERTA
    
    // Pegar o idMaquina
    var idMaquina = {};
    var listaID = [];
    fetch(`/medidas/obterIdMaquina`, {
        cache: 'no-store',
        method: "GET",
    }).then(function (response) {
        if (response.ok) {

            response.json().then(function (resposta) {
                console.log("Dados recebidos: ", JSON.stringify(resposta));
                var feed = document.getElementById("feed_container");
                var colunas = document.getElementById("colunas-container");
                feed.appendChild(colunas);

                for (let i = 0; i < resposta.length; i++) {
                    var publicacao = resposta[i];
                    listaID.push(publicacao.idMaquina);

                    var linha = document.createElement("tr");
                    var maquina = document.createElement("td");

                    //sessionStorage.ID_MAQUINA;
                    maquina.innerHTML = `<a onclick= "pegarIdMaquina(${i})" id= "${publicacao.idMaquina}" href="dashboardEspecífica.html"><span>${publicacao.idMaquina}</span></a>`;

                    feed.appendChild(linha);
                    linha.appendChild(maquina);

                    console.log("ESSE É O ID DA MAQUINA " + i.idMaquina);
                }
            });
        } else {
            console.error('Não foi encontrado o idMaquina');
        }
    })
        .catch(function (error) {
            console.error(`Erro ao obter idMaquina ${error.message}`);
        });

    function pegarIdMaquina(numMaquina) {
        listaID[numMaquina]
        sessionStorage.setItem('idMaquina', JSON.stringify(listaID[numMaquina]));
    }
    // FIM - Pegar o idMaquina

    // Funções para funcionar a dash

    function obterDadosGrafico() {
        fetch(`/medidas/obterDadosRede`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Pacotes Recebidos',
                data: [],
                fill: false,
                tension: 0.1,
                tension: 0.1,
                backgroundColor: '#00323c',
                borderColor: '#00323c',
                borderWidth: 1
            },
            {
                label: 'Pacotes Enviados',
                data: [],
                fill: false,
                tension: 0.1,
                backgroundColor: '#00d5ffb9',
                borderColor: '#00d5ffb9',
                borderWidth: 1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medBytesRecebido && registro.medBytesEnviado != "null") {
                labels.push(registro.hostName);
                dados.datasets[0].data.push(registro.medBytesRecebido);
                dados.datasets[1].data.push(registro.medBytesEnviado);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Bytes recebidos e Bytes enviados pela rede'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart = new Chart(
            document.getElementById(`myChart2`),
            config
        );
        myChart.update();
        setTimeout(() => atualizarGrafico(dados, myChart), 2000);
    }

    function atualizarGrafico(dados, myChart) {


        fetch(`/medidas/obterDadosRede`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    // tirando e colocando valores no gráfico

                    for (i = 0; i < novoRegistro.length; i++) {
                        var registro = novoRegistro[i];

                        dados.labels.shift(novoRegistro[i].hostName); // apagar o primeiro
                        dados.labels.push(novoRegistro[i].hostName); // incluir um novo momento

                        dados.datasets[0].data.shift(novoRegistro[i].medBytesRecebido);  // apagar o primeiro de umidade
                        dados.datasets[0].data.push(novoRegistro[i].medBytesRecebido); // incluir uma nova medida de umidade

                        dados.datasets[1].data.shift(novoRegistro[i].medBytesEnviado);  // apagar o primeiro de temperatura
                        dados.datasets[1].data.push(novoRegistro[i].medBytesEnviado); // incluir uma nova medida de temperatura
                    }

                    myChart.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico(dados, myChart), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico(dados, myChart), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }


    // DASH DISCO

    function obterDadosGrafico2() {
        fetch(`/medidas/obterDadosDisco`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico2(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico2(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Uso atual do disco',
                data: [],
                fill: false,
                tension: 0.1,
                backgroundColor: '#00323c',
                borderColor: '#00323c',
                borderWidth: 1
            },
            {
                label: 'Disco disponível',
                data: [],
                fill: false,
                tension: 0.1,
                backgroundColor: '#00d5ffb9',
                borderColor: '#00d5ffb9',
                borderWidth: 1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medUsoAtualDisco && registro.medUsoDisponivelDisco != "null") {
                labels.push(registro.hostName);
                dados.datasets[0].data.push(registro.medUsoAtualDisco);
                dados.datasets[1].data.push(registro.medUsoDisponivelDisco);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'bar',
            data: dados,
            options: {
                indexAxis: 'y',
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Média do uso do disco e da quantidade disponível'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart2 = new Chart(
            document.getElementById(`myChart3`),
            config
        );
        myChart2.update();
        setTimeout(() => atualizarGrafico2(dados, myChart2), 2000);
    }


    function atualizarGrafico2(dados, myChart2) {

        fetch(`/medidas/obterDadosDisco`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico2();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    for (i = 0; i < novoRegistro.length; i++) {
                        var registro = novoRegistro[i];

                        dados.labels.shift(novoRegistro[i].hostName); // apagar o primeiro
                        dados.labels.push(novoRegistro[i].hostName); // incluir um novo momento

                        dados.datasets[0].data.shift(novoRegistro[i].medUsoAtualDisco);  // apagar o primeiro de umidade
                        dados.datasets[0].data.push(novoRegistro[i].medUsoAtualDisco); // incluir uma nova medida de umidade

                        dados.datasets[1].data.shift(novoRegistro[i].medUsoDisponivelDisco);  // apagar o primeiro de temperatura
                        dados.datasets[1].data.push(novoRegistro[i].medUsoDisponivelDisco); // incluir uma nova medida de temperatura
                    }

                    myChart2.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico2(dados, myChart2), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico2(dados, myChart2), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }


    // DASH CPU

    function obterDadosGrafico3() {
        fetch(`/medidas/obterDadosCPU`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico3(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico3(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Uso da CPU',
                data: [],
                fill: false,
                tension: 0.1,
                backgroundColor: '#00323c',
                borderColor: '#00323c',
                borderWidth: 1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medUsoAtualCpu != "null") {
                labels.push(registro.hostName);
                dados.datasets[0].data.push(registro.medUsoAtualCpu);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'line',
            data: dados,
            options: {
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Média do uso da CPU'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart3 = new Chart(
            document.getElementById(`myChart1`),
            config
        );
        myChart3.update();
        setTimeout(() => atualizarGrafico3(dados, myChart3), 2000);
    }


    function atualizarGrafico3(dados, myChart3) {

        fetch(`/medidas/obterDadosCPU`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico3();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    for (i = 0; i < novoRegistro.length; i++) {
                        var registro = novoRegistro[i];

                        dados.labels.shift(novoRegistro[i].hostName); // apagar o primeiro
                        dados.labels.push(novoRegistro[i].hostName); // incluir um novo momento

                        dados.datasets[0].data.shift(novoRegistro[i].medUsoAtualCpu);  // apagar o primeiro de umidade
                        dados.datasets[0].data.push(novoRegistro[i].medUsoAtualCpu); // incluir uma nova medida de umidade
                    }

                    myChart3.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico3(dados, myChart3), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico3(dados, myChart3), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }




    // DASH RAM

    function obterDadosGrafico4() {
        fetch(`/medidas/obterDadosRAM`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico4(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico4(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Memoria Em Uso',
                data: [],
                fill: false,
                tension: 0.1,
                backgroundColor: '#00323c',
                borderColor: '#00323c',
                borderWidth: 1
            },
            {
                label: 'Memoria Disponível',
                data: [],
                fill: false,
                tension: 0.1,
                backgroundColor: '#00d5ffb9',
                borderColor: '#00d5ffb9',
                borderWidth: 1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medMemoriaEmUso && registro.medMemoriaDisponivel != "null") {
                labels.push(registro.hostName);
                dados.datasets[0].data.push(registro.medMemoriaEmUso);
                dados.datasets[1].data.push(registro.medMemoriaDisponivel);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Memória em uso e memória disponível da RAM'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart4 = new Chart(
            document.getElementById(`myChart4`),
            config
        );
        myChart4.update();
        setTimeout(() => atualizarGrafico4(dados, myChart4), 2000);
    }


    function atualizarGrafico4(dados, myChart4) {

        fetch(`/medidas/obterDadosRAM`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico4();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    for (i = 0; i < novoRegistro.length; i++) {
                        var registro = novoRegistro[i];

                        dados.labels.shift(novoRegistro[i].hostName); // apagar o primeiro
                        dados.labels.push(novoRegistro[i].hostName); // incluir um novo momento

                        dados.datasets[0].data.shift(novoRegistro[i].medMemoriaEmUso);  // apagar o primeiro de umidade
                        dados.datasets[0].data.push(novoRegistro[i].medMemoriaEmUso); // incluir uma nova medida de umidade

                        dados.datasets[1].data.shift(novoRegistro[i].medMemoriaDisponivel);  // apagar o primeiro de umidade
                        dados.datasets[1].data.push(novoRegistro[i].medMemoriaDisponivel); // incluir uma nova medida de umidade
                    }

                    myChart4.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico4(dados, myChart4), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico4(dados, myChart4), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }