<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Geral Fármacos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../styles/css-dash/dashboard.css">
    <link rel="icon" href="../img/logo F png.png">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"
        integrity="sha512-t2JWqzirxOmR9MZKu+BMz0TNHe55G5BZ/tfTmXMlxpUY8tsTo3QMD27QGoYKZKFAraIPDhFv56HLdN11ctmiTQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>
</head>

<body onload="obterDadosGrafico(), obterDadosGrafico2(), obterDadosGrafico3(), obterDadosGrafico4()">
    <div class="conteudo">
        <div class="nav-lateral">
            <div class="logo-empresa">
                <img src="./../img/logo F png.png" alt="">
            </div>
            <div class="nav-itens">
                <li>
                    <ul><b>Nome</b></ul>
                    <ul><a href="cadastroAlerta.html">Alertas</a></ul>
                    <ul><a class="atual" href="dashboardGeral.html">Máquinas</a></ul>
                    <ul><a href="./listaUsuario.html">Usuários</a></ul>
                    <ul><a href="./editarDados.html">Editar dados</a></ul>
                </li>
            </div>
            <div class="btn-pdf"><button>Gerar PDF</button></div>
            <div class="btn-sair">
                <button>Sair</button>
            </div>
        </div>
        <div class="div-principal">
            <div class="div-superior">
                <div class="div-cpu">
                    <h2>CPU</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>
                </div>
                <div class="div-ram">
                    <h2>Memoria RAM</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>

                </div>
                <div class="div-rede">
                    <h2>Rede</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>
                </div>

                <div class="div-disco">
                    <h2>Disco</h2>
                    <div class="descricao-componente">
                        <img src="../img/aviso (1).png" alt="">
                        <p>Preocupante 60%</p>
                    </div>
                    <div class="descricao-componente">
                        <img src="../img/aviso.png" alt="">
                        <p>Critico 85%</p>
                    </div>
                </div>
            </div>
            <div class="div-central">
                <div class="div-tab-ram">
                    <!-- <table>
                        <tr>
                            <th>Identificação da Máquina</th>
                            <th>Uso atual</th>
                            <th>Total de Ram</th>
                        </tr>
                        <tr>
                            <th>Máquina 1</th>
                            <th>60%</th>
                            <th>12 GB</th>
                        </tr>
                        <tr>
                            <th>Máquina 2</th>
                            <th>55%</th>
                            <th>8 GB</th>
                        </tr>
                    </table> -->
                    <canvas id="myChart4" style="width: 400px; height: 220px;"></canvas>
                </div>
                <div class="div-graf-disco">
                    <canvas id="myChart3" style="width: 400px; height: 220px;"></canvas>
                </div>

                <div class="div-list-maquinas">
                    <h2>Lista de Máquinas</h2>
                    <table>
                        <tr>
                            <th><a href=""> Geral</a></th>
                            <th></th>
                        </tr>
                        <tr id="listaMaquina">

                        </tr>
                    </table>
                </div>
            </div>
            <div class="div-inferior">
                <div class="div-graf-rede">
                    <canvas id="myChart2" style="width: 700px; height: 400px;"></canvas>
                </div>
                <div class="div-graf-cpu">
                    <canvas id="myChart1" style="width: 400px; height: 260px;"></canvas>
                </div>
                <div class="div-list-alertas">
                    <h2>Alertas</h2>
                    <table>
                        <tr>
                            <th><a href=""> </a></th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 1</a></th>
                            <th>16:02</th>
                            <th>CPU: 80%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 2</a></th>
                            <th>16:02</th>
                            <th>RAM: 90%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 3</a></th>
                            <th>09:02</th>
                            <th>DISCO: 98%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 1</a></th>
                            <th>19:02</th>
                            <th>CPU: 90%</th>
                        </tr>
                        <tr>
                            <th><a href="">Máquina 3</a></th>
                            <th>16:02</th>
                            <th>CPU: 90%</th>
                        </tr>

                    </table>
                </div>
            </div>

            <!-- <canvas id="myChart3" style="width: 250px; height: 200px;"></canvas> -->


        </div>
    </div>
</body>

<script>
    const btnPrint = document.querySelector(".btn-pdf");
    btnPrint.addEventListener("click", () => {

        const navLateral = document.querySelector(".nav-lateral"); // Supondo que "nav-lateral" é uma classe
        const divPrincipal = document.querySelector(".div-principal");

        if (navLateral) {
            navLateral.style.display = "none";
        }

        if (divPrincipal) {
            divPrincipal.style.width = "100%";
            divPrincipal.style.left = "0%";
        }
        // Cria uma folha de estilo CSS dinâmica para a impressão
        const printStyles = `
                @page {
                    size: A3 landscape; /* Tamanho da folha, pode ser A4, letter, legal, etc. */
                    margin: 1cm; /* Margens da página (por exemplo, 1cm em todos os lados) */
                }
            `;
        const style = document.createElement('style');
        style.textContent = printStyles;
        document.head.appendChild(style);

        // Inicia o diálogo de impressão
        window.print();

        if (navLateral) {
            navLateral.style.display = "flex";
        }

        if (divPrincipal) {
            divPrincipal.style.width = "81%";
            divPrincipal.style.left = "19%";
        }

        // Remove a folha de estilo após a impressão
        style.remove();
    });

    // const ctx4 = document.getElementById('myChart4');

    // new Chart(ctx4, {
    //     data: {
    //         datasets: [{
    //             type: 'bar',
    //             label: 'Gráfico de Disco',
    //             data: [12, 19, 15, 12, 17], // captura de rede
    //             borderWidth: 1,
    //             // backgroundColor: 'pink',
    //         }],
    //         labels: ['Máquina 1', 'Máquina 2']
    //     },
    //     options: {
    //         indexAxis: 'y',
    //         plugins: {
    //             legend: {
    //                 display: true,
    //                 position: 'bottom'
    //             },
    //             title: {
    //                 display: true,
    //                 text: 'Comparativo de Uso de Disco entre máquinas '
    //             }
    //         },
    //         // scales: {
    //         //     y: {
    //         //         beginAtZero: true
    //         //     }
    //         // }
    //     }
    // });

    // const ctx1 = document.getElementById('myChart1');

    // new Chart(ctx1, {
    //     type: 'line',
    //     data: {
    //         labels: [1, 2, 3, 4, 5, 6,], // colocar as horas
    //         datasets: [{
    //             type: 'line',
    //             label: 'Alerta preocupante',
    //             data: [10, 10, 10, 10, 10, 10],
    //             borderWidth: 1.5,
    //             borderColor: '#6dc7ff',
    //             backgroundColor: '#6dc7ff',
    //         },
    //         {
    //             type: 'line',
    //             label: 'Alerta crítico',
    //             data: [20, 20, 20, 20, 20, 20],
    //             borderWidth: 1.5,
    //             borderColor: 'red',
    //             backgroundColor: 'red',
    //         },
    //         {
    //             label: 'Uso de CPU',
    //             data: [12, 19, 3, 5, 2, 3], // colocar o uso
    //             borderWidth: 3,
    //             borderColor: '#00323c',
    //             backgroundColor: '#00323c',
    //         }]
    //     },
    //     // configurar a cor de fundo
    //     const: bgColor = {
    //         id: 'bgColor',
    //         beforeDraw(chart1, steps, options) {
    //             const { ctx, chartArea: { ctx1, width, height } } = chart1;
    //             ctx1.faleStyle = 'options.backgroundColor';
    //             ctx1.fillRect(0, 0, width, height);
    //             ctx1.restore();
    //         }

    //     },

    //     options: {
    //         scales: {
    //             y: {
    //                 beginAtZero: true
    //             }
    //         },

    //         plugins: {
    //             title: {
    //                 display: true,
    //                 text: 'Uso de CPU em porcentagem em decorrência do tempo',
    //                 fontSize: 50,

    //             },
    //             legend: {
    //                 display: true,
    //                 position: 'bottom'
    //             },
    //             // cor de fundo da imagem
    //             bgColor: {
    //                 backgroundColor: 'white'
    //             }
    //         },
    //     }

    // });

    // function downloadPDF() {
    //     const canvas = document.getElementById('myChart1');
    //     //const canvas1 = document.getElementById('myChart2');
    //     //const canvas2 = document.getElementById('myChart3');
    //     //const canvas3 = document.getElementById('myChart4');

    //     //create image
    //     const canvasImage = canvas.toDataURL('image/jpeg', 1.0);
    //     //const canvasImage1 = canvas1.toDataURL('image/jpeg', 1.0);
    //     // const canvasImage2 = canvas2.toDataURL('image/jpeg', 1.0);
    //     // const canvasImage3 = canvas3.toDataURL('image/jpeg', 1.0);

    //     console.log(canvasImage);

    //     let pdf = new jsPDF('landscape');
    //     pdf.setFontSize(20);
    //     pdf.addImage(canvasImage, 'JPEG', 0, 0, 150, 150);
    //     pdf.save('mychart.pdf');

    // }


    // Pegar o idMaquina
    var idMaquina = {};
    fetch(`/medidas/obterIdMaquina`, {
        cache: 'no-store',
        method: "GET",
    }).then(function (response) {
        if (response.ok) {


            response.json().then(function (resposta) {
                // console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                // plotarGrafico(resposta);
                idMaquina = resposta
                for (const i of resposta) {
                    listaMaquina.innerHTML += i.idMaquina;
                    console.log("ESSE È O ID DA MAQUINA" + i.idMaquina);
                }

            });
        } else {
            console.error('Não foi encontrado o idMaquina');
        }
    })
        .catch(function (error) {
            console.error(`Erro ao obter idMaquina ${error.message}`);
        });

    // FIM - Pegar o idMaquina

    // Funções para funcionar a dash

    function obterDadosGrafico() {
        fetch(`/medidas/obterDadosRede`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Pacotes Recebidos',
                data: [],
                fill: false,
                tension: 0.1
            },
            {
                label: 'Pacotes Enviados',
                data: [],
                fill: false,
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medBytesRecebido && registro.medBytesEnviado != "null") {
                labels.push(registro.fkMaquina);
                dados.datasets[0].data.push(registro.medBytesRecebido);
                dados.datasets[1].data.push(registro.medBytesEnviado);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Bytes recebidos e Bytes enviados pela rede'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart = new Chart(
            document.getElementById(`myChart2`),
            config
        );
        myChart.update();
        setTimeout(() => atualizarGrafico(dados, myChart), 2000);
    }

    function atualizarGrafico(dados, myChart) {


        fetch(`/medidas/obterDadosRede`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    // tirando e colocando valores no gráfico
                    dados.labels.shift(); // apagar o primeiro
                    dados.labels.push(novoRegistro[0].fkMaquina); // incluir um novo momento

                    dados.datasets[0].data.shift();  // apagar o primeiro de umidade
                    dados.datasets[0].data.push(novoRegistro[0].medBytesRecebido); // incluir uma nova medida de umidade

                    dados.datasets[1].data.shift();  // apagar o primeiro de temperatura
                    dados.datasets[1].data.push(novoRegistro[0].medBytesEnviado); // incluir uma nova medida de temperatura
                    myChart.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico(dados, myChart), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico(dados, myChart), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }


    // DASH DISCO

    function obterDadosGrafico2() {
        fetch(`/medidas/obterDadosDisco`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico2(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico2(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Uso atual do disco',
                data: [],
                fill: false,
                tension: 0.1
            },
            {
                label: 'Disco disponível',
                data: [],
                fill: false,
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medUsoAtualDisco && registro.medUsoDisponivelDisco != "null") {
                labels.push(registro.fkMaquina);
                dados.datasets[0].data.push(registro.medUsoAtualDisco);
                dados.datasets[1].data.push(registro.medUsoDisponivelDisco);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Média do uso do disco e da quantidade disponível'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart2 = new Chart(
            document.getElementById(`myChart3`),
            config
        );
        myChart2.update();
        setTimeout(() => atualizarGrafico2(dados, myChart2), 2000);
    }


    function atualizarGrafico2(dados, myChart2) {

        fetch(`/medidas/obterDadosDisco`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico2();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    // tirando e colocando valores no gráfico
                    dados.labels.shift(); // apagar o primeiro
                    dados.labels.push(novoRegistro[0].fkMaquina); // incluir um novo momento

                    dados.datasets[0].data.shift();  // apagar o primeiro de umidade
                    dados.datasets[0].data.push(novoRegistro[0].medUsoAtualDisco); // incluir uma nova medida de umidade

                    dados.datasets[1].data.shift();  // apagar o primeiro de temperatura
                    dados.datasets[1].data.push(novoRegistro[0].medUsoDisponivelDisco); // incluir uma nova medida de temperatura

                    myChart2.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico2(dados, myChart2), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico2(dados, myChart2), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }


    // DASH CPU

    function obterDadosGrafico3() {
        fetch(`/medidas/obterDadosCPU`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico3(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico3(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Uso da CPU',
                data: [],
                fill: false,
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medUsoAtualCpu != "null") {
                labels.push(registro.fkMaquina);
                dados.datasets[0].data.push(registro.medUsoAtualCpu);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'line',
            data: dados,
            options: {
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Média do uso da CPU'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart3 = new Chart(
            document.getElementById(`myChart1`),
            config
        );
        myChart3.update();
        setTimeout(() => atualizarGrafico3(dados, myChart3), 2000);
    }


    function atualizarGrafico3(dados, myChart3) {

        fetch(`/medidas/obterDadosCPU`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico3();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    // tirando e colocando valores no gráfico
                    dados.labels.shift(); // apagar o primeiro
                    dados.labels.push(novoRegistro[0].fkMaquina); // incluir um novo momento

                    dados.datasets[0].data.shift();  // apagar o primeiro de umidade
                    dados.datasets[0].data.push(novoRegistro[0].medUsoAtualCpu); // incluir uma nova medida de umidade

                    myChart3.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico3(dados, myChart3), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico3(dados, myChart3), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }




    // DASH RAM

    function obterDadosGrafico4() {
        fetch(`/medidas/obterDadosRAM`, {
            cache: 'no-store',
            method: "GET",
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    plotarGrafico4(resposta);
                    console.log(resposta)

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico4(resposta) {
        console.log('iniciando plotagem do gráfico...');
        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Memoria Em Uso',
                data: [],
                fill: false,
                tension: 0.1
            },
            {
                label: 'Memoria Disponível',
                data: [],
                fill: false,
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            if (registro.medMemoriaEmUso && registro.medMemoriaDisponivel != "null") {
                labels.push(registro.fkMaquina);
                dados.datasets[0].data.push(registro.medMemoriaEmUso);
                dados.datasets[1].data.push(registro.medMemoriaDisponivel);
            }

            console.log(registro)

        }
        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom'
                    },
                    title: {
                        display: true,
                        text: 'Memória em uso e memória disponível da RAM'
                    }
                }
            }
        };

        // Adicionando gráfico criado em div na tela
        myChart4 = new Chart(
            document.getElementById(`myChart4`),
            config
        );
        myChart4.update();
        setTimeout(() => atualizarGrafico4(dados, myChart4), 2000);
    }


    function atualizarGrafico4(dados, myChart4) {

        fetch(`/medidas/obterDadosRAM`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    obterDadosGrafico4();
                    // alertar(novoRegistro, idAquario);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura`)
                    // avisoCaptura.innerHTML = ""

                    // tirando e colocando valores no gráfico
                    dados.labels.shift(); // apagar o primeiro
                    dados.labels.push(novoRegistro[0].fkMaquina); // incluir um novo momento

                    dados.datasets[0].data.shift();  // apagar o primeiro de umidade
                    dados.datasets[0].data.push(novoRegistro[0].medMemoriaEmUso); // incluir uma nova medida de umidade

                    dados.datasets[1].data.shift();  // apagar o primeiro de temperatura
                    dados.datasets[1].data.push(novoRegistro[0].medMemoriaDisponivel); // incluir uma nova medida de temperatura
                    myChart4.update();
                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico4(dados, myChart4), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico4(dados, myChart4), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }
</script>